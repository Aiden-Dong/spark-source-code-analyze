-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 16


-- !query 0
CREATE OR REPLACE TEMPORARY VIEW t1 AS VALUES (1, 'a'), (2, 'b') tbl(c1, c2)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
CREATE OR REPLACE TEMPORARY VIEW t2 AS VALUES (1.0, 1), (2.0, 4) tbl(c1, c2)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
SELECT *
FROM   (SELECT * FROM t1
        UNION ALL
        SELECT * FROM t1)
-- !query 2 schema
struct<c1:int,c2:string>
-- !query 2 output
1	a
1	a
2	b
2	b


-- !query 3
SELECT *
FROM   (SELECT * FROM t1
        UNION ALL
        SELECT * FROM t2
        UNION ALL
        SELECT * FROM t2)
-- !query 3 schema
struct<c1:decimal(11,1),c2:string>
-- !query 3 output
1	1
1	1
1	a
2	4
2	4
2	b


-- !query 4
SELECT a
FROM (SELECT 0 a, 0 b
      UNION ALL
      SELECT SUM(1) a, CAST(0 AS BIGINT) b
      UNION ALL SELECT 0 a, 0 b) T
-- !query 4 schema
struct<a:bigint>
-- !query 4 output
0
0
1


-- !query 5
CREATE OR REPLACE TEMPORARY VIEW p1 AS VALUES 1 T(col)
-- !query 5 schema
struct<>
-- !query 5 output



-- !query 6
CREATE OR REPLACE TEMPORARY VIEW p2 AS VALUES 1 T(col)
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
CREATE OR REPLACE TEMPORARY VIEW p3 AS VALUES 1 T(col)
-- !query 7 schema
struct<>
-- !query 7 output



-- !query 8
SELECT 1 AS x,
       col
FROM   (SELECT col AS col
        FROM (SELECT p1.col AS col
              FROM   p1 CROSS JOIN p2
              UNION ALL
              SELECT col
              FROM p3) T1) T2
-- !query 8 schema
struct<x:int,col:int>
-- !query 8 output
1	1
1	1


-- !query 9
SELECT map(1, 2), 'str'
UNION ALL
SELECT map(1, 2, 3, NULL), 1
-- !query 9 schema
struct<map(1, 2):map<int,int>,str:string>
-- !query 9 output
{1:2,3:null}	1
{1:2}	str


-- !query 10
SELECT array(1, 2), 'str'
UNION ALL
SELECT array(1, 2, 3, NULL), 1
-- !query 10 schema
struct<array(1, 2):array<int>,str:string>
-- !query 10 output
[1,2,3,null]	1
[1,2]	str


-- !query 11
DROP VIEW IF EXISTS t1
-- !query 11 schema
struct<>
-- !query 11 output



-- !query 12
DROP VIEW IF EXISTS t2
-- !query 12 schema
struct<>
-- !query 12 output



-- !query 13
DROP VIEW IF EXISTS p1
-- !query 13 schema
struct<>
-- !query 13 output



-- !query 14
DROP VIEW IF EXISTS p2
-- !query 14 schema
struct<>
-- !query 14 output



-- !query 15
DROP VIEW IF EXISTS p3
-- !query 15 schema
struct<>
-- !query 15 output

