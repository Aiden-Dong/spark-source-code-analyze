-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 9


-- !query 0
CREATE TEMPORARY VIEW tbl_x AS VALUES
  (1, NAMED_STRUCT('C', 'gamma', 'D', 'delta')),
  (2, NAMED_STRUCT('C', 'epsilon', 'D', 'eta')),
  (3, NAMED_STRUCT('C', 'theta', 'D', 'iota'))
  AS T(ID, ST)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
SELECT STRUCT('alpha', 'beta') ST
-- !query 1 schema
struct<ST:struct<col1:string,col2:string>>
-- !query 1 output
{"col1":"alpha","col2":"beta"}


-- !query 2
SELECT STRUCT('alpha' AS A, 'beta' AS B) ST
-- !query 2 schema
struct<ST:struct<A:string,B:string>>
-- !query 2 output
{"A":"alpha","B":"beta"}


-- !query 3
SELECT ID, STRUCT(ST.*) NST FROM tbl_x
-- !query 3 schema
struct<ID:int,NST:struct<C:string,D:string>>
-- !query 3 output
1	{"C":"gamma","D":"delta"}
2	{"C":"epsilon","D":"eta"}
3	{"C":"theta","D":"iota"}


-- !query 4
SELECT ID, STRUCT(ST.*,CAST(ID AS STRING) AS E) NST FROM tbl_x
-- !query 4 schema
struct<ID:int,NST:struct<C:string,D:string,E:string>>
-- !query 4 output
1	{"C":"gamma","D":"delta","E":"1"}
2	{"C":"epsilon","D":"eta","E":"2"}
3	{"C":"theta","D":"iota","E":"3"}


-- !query 5
SELECT ID, STRUCT(CAST(ID AS STRING) AS AA, ST.*) NST FROM tbl_x
-- !query 5 schema
struct<ID:int,NST:struct<AA:string,C:string,D:string>>
-- !query 5 output
1	{"AA":"1","C":"gamma","D":"delta"}
2	{"AA":"2","C":"epsilon","D":"eta"}
3	{"AA":"3","C":"theta","D":"iota"}


-- !query 6
SELECT ID, STRUCT(ST.*).C NST FROM tbl_x
-- !query 6 schema
struct<ID:int,NST:string>
-- !query 6 output
1	gamma
2	epsilon
3	theta


-- !query 7
SELECT ID, STRUCT(ST.C, ST.D).D NST FROM tbl_x
-- !query 7 schema
struct<ID:int,NST:string>
-- !query 7 output
1	delta
2	eta
3	iota


-- !query 8
SELECT ID, STRUCT(ST.C as STC, ST.D as STD).STD FROM tbl_x
-- !query 8 schema
struct<ID:int,named_struct(STC, ST.C AS `C` AS `STC`, STD, ST.D AS `D` AS `STD`).STD:string>
-- !query 8 output
1	delta
2	eta
3	iota
